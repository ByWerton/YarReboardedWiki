<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yar Reboarded Wiki - Final</title>
<style>
body { font-family: Arial; margin:0; background:#f0f0f0;}
#menu{position:fixed;left:0;top:0;width:200px;height:100vh;background:#222;color:#fff;padding:10px;}
#menu button{display:block;width:100%;margin:5px 0;cursor:pointer;}
#content{margin-left:210px;padding:20px;}
.section{display:none;}
.section.active{display:block;}
.block{border:1px solid #aaa;padding:10px;margin-bottom:10px;background:#fff;}
.hidden{display:none;}
input, textarea{width:100%;margin:5px 0;padding:5px;}
img{max-width:150px; display:block; margin-top:5px;}
</style>
</head>
<body>

<div id="menu">
<h3>Menu</h3>
<button onclick="showSection('home')">Ana Sayfa</button>
<button onclick="showSection('kargolar')">Kargolar</button>
<button onclick="showSection('maps')">Mapler</button>
<button onclick="showSection('blocks')">Blocklar</button>
<button onclick="showSection('comments')">Yorumlar</button>
<button id="adminBtn" class="hidden" onclick="showSection('admin')">Admin Panel</button>
<hr>
<button onclick="logout()">Çıkış Yap</button>
</div>

<div id="content">
<div id="home" class="section active">
<h1>Hoşgeldiniz!</h1>
<p>Yar Reboarded Wiki Final</p>
</div>

<div id="kargolar" class="section">
<h2>Kargolar</h2>
<div id="cargoList"></div>
<div id="addCargoAdmin" class="hidden">
<input type="text" id="cargoName" placeholder="Kargo Adı">
<input type="number" id="cargoHP" placeholder="Kargo Canı">
<textarea id="cargoDesc" placeholder="Açıklama"></textarea>
<input type="file" id="cargoImage">
<button onclick="addCargo()">Yeni Kargo Ekle</button>
</div>
</div>

<div id="maps" class="section">
<h2>Mapler</h2>
<div id="mapList"></div>
<div id="addMapAdmin" class="hidden">
<input type="text" id="mapName" placeholder="Map Adı">
<textarea id="mapDesc" placeholder="Açıklama"></textarea>
<input type="file" id="mapImage">
<button onclick="addMap()">Yeni Map Ekle</button>
</div>
</div>

<div id="blocks" class="section">
<h2>Blocklar</h2>
<div id="blockList"></div>
<div id="addBlockAdmin" class="hidden">
<input type="text" id="blockName" placeholder="Block Adı">
<input type="number" id="blockHP" placeholder="Block Canı">
<input type="number" id="blockDamage" placeholder="Block Hasarı">
<textarea id="blockDesc" placeholder="Açıklama"></textarea>
<input type="file" id="blockImage">
<button onclick="addBlock()">Yeni Block Ekle</button>
</div>
</div>

<div id="comments" class="section">
<h2>Yorumlar</h2>
<div id="commentList"></div>
<textarea id="commentInput" placeholder="Yorum yaz..."></textarea>
<button onclick="addComment()">Yorum Gönder</button>
</div>

<div id="admin" class="section">
<h2>Admin Panel</h2>
<p>Admin olarak tüm kargo, map, block ve yorumları yönetebilirsiniz.</p>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, push, onValue, remove, set } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
apiKey: "AIzaSyCcLP7390AotwSTUzZLTOmiglNs1a1OxxU",
authDomain: "yarreboardedwiki.firebaseapp.com",
databaseURL: "https://yarreboardedwiki-default-rtdb.firebaseio.com",
projectId: "yarreboardedwiki",
storageBucket: "yarreboardedwiki.firebasestorage.app",
messagingSenderId: "365304875142",
appId: "1:365304875142:web:5d962e22c249917745a907",
measurementId: "G-KCDR6CW19E"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

const adminEmail = "selimhanlafci121@gmail.com";

function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function logout(){ signOut(auth).then(()=>location.reload()); }

function getBase64(file){return new Promise(resolve=>{const reader=new FileReader();reader.onload=()=>resolve(reader.result);reader.readAsDataURL(file);});}

// Yorumlar
function addComment(){
  const text=document.getElementById('commentInput').value;
  if(!text)return;
  push(ref(db,'comments'),{text,timestamp:Date.now()});
  document.getElementById('commentInput').value='';
}
onValue(ref(db,'comments'),snap=>{
  const list=document.getElementById('commentList');
  list.innerHTML='';
  snap.forEach(c=>{
    const data=c.val();
    const div=document.createElement('div');
    div.textContent=data.text;
    list.appendChild(div);
  });
});

// Admin kontrolü
onAuthStateChanged(auth,user=>{
  if(user && user.email===adminEmail){
    document.getElementById('adminBtn').classList.remove('hidden');
    document.getElementById('addCargoAdmin').classList.remove('hidden');
    document.getElementById('addMapAdmin').classList.remove('hidden');
    document.getElementById('addBlockAdmin').classList.remove('hidden');
  }
});

// Kargo ekleme
async function addCargo(){
  const name=document.getElementById('cargoName').value;
  const hp=document.getElementById('cargoHP').value;
  const desc=document.getElementById('cargoDesc').value;
  const file=document.getElementById('cargoImage').files[0];
  let img='';
  if(file) img=await getBase64(file);
  push(ref(db,'kargolar'),{name,hp,desc,img});
}

// Map ekleme
async function addMap(){
  const name=document.getElementById('mapName').value;
  const desc=document.getElementById('mapDesc').value;
  const file=document.getElementById('mapImage').files[0];
  let img='';
  if(file) img=await getBase64(file);
  push(ref(db,'maps'),{name,desc,img});
}

// Block ekleme
async function addBlock(){
  const name=document.getElementById('blockName').value;
  const hp=document.getElementById('blockHP').value;
  const dmg=document.getElementById('blockDamage').value;
  const desc=document.getElementById('blockDesc').value;
  const file=document.getElementById('blockImage').files[0];
  let img='';
  if(file) img=await getBase64(file);
  push(ref(db,'blocks'),{name,hp,dmg,desc,img});
}
</script>
</body>
</html>
